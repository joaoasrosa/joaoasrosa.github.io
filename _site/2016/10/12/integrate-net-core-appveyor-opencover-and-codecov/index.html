<p>As a developer, I need to take a good rest at night. In my line of work the only way to achieve it is using an integrated workflow pipeline, aka Source Code Management (SCM), Continuous Integration (CI) and Continuous Deployment (CD) with some tools in the middle.</p>
<p>For my <a href="https://github.com/joaoasrosa/unittestsexternalsources">new pet project</a> (I will write about it once reach a good maturity level) I use this set of tools/technologies:</p>
<ul>
<li><a href="https://www.microsoft.com/net/core">.NET Core</a> as the framework</li>
<li><a href="https://github.com/">GitHub</a> as SCM</li>
<li><a href="https://www.appveyor.com/">AppVeyor</a> as CI &amp; CD</li>
<li><a href="https://github.com/OpenCover/opencover">OpenCover</a> as Code Coverage Reporting Generator</li>
<li><a href="https://codecov.io/">CodeCov</a> as Code Coverage Repository</li>
<li><a href="http://nuget.org/">NuGet</a> as repository for project packages</li>
</ul>
<p>OpenCover is the most used framework to generate code coverage reports for .NET framework. It's open source and well maintain (updated to work with .NET Core).</p>
<p>Codecov is a commercial project from <a href="https://twitter.com/iopeak">Steve Peak</a>, free for open source projects, and has powerful visualisations from the code coverage report. Can be used with a tonne of frameworks/languages, using OpenCover report format for the .NET framework. Is my preferred platform, since Steve has a great customer service support.</p>
<p>My integrated workflow pipeline is:</p>
<ol>
<li>Commit to GitHub project</li>
<li>AppVeyor is configured to be triggered when a new commit is done</li>
<li>AppVeyor builds the solution, run the tests and generate the code coverage report</li>
<li>AppVeyor publish the code coverage report to CodeCov</li>
</ol>
<p>To manage the AppVeyor actions during the build and tests phases I just develop a PowerShell script to run the generate the code coverage report using OpenCover for the projects/classes under test:</p>
<p>https://gist.github.com/joaoasrosa/80a322d57ee6243374f2463f9a41d05f</p>
<p>The script instructions do the following:</p>
<ol>
<li>Set as parameters the general configurations, such as locations of the code coverage report, OpenCover and .NET, using the <a href="https://www.appveyor.com/docs/environment-variables/">AppVeyor environment variables</a> to set the correct path</li>
<li>Set the parameters to test the WebAPplicationAssemblyStorage project, excluding a dummy class, running the OpenCover console using the parameters</li>
<li>Set the parameters to test the WebApp project, excluding all the bootstrapping code generated by the .NET framework when a web app is created, running the OpenCover console using the parameters</li>
<li>Copy the code coverage report to the AppVeyor artifacts</li>
<li>Set the Python version in the PATH environment variable, installing Python Package Manager and Codecov script, and uploading the code coverage report to Codecov</li>
</ol>
<p>The Powershell is integrated into <a href="https://github.com/joaoasrosa/unittestsexternalsources/blob/master/appveyor.yml">appveyor.yml</a> file, integrated into the project solution. The script runs in the 'test_script' step.</p>
<p>NOTE: at the time that you are reading this post the script can be different. If that is the case please leave a comment and I will update the Gist. :)</p>
